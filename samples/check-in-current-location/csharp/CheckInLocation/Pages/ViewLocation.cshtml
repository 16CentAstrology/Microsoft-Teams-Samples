@page
@model CheckInLocation.Pages.ViewLocationModel
@{
}
<head>
    <script src="https://statics.teams.cdn.office.net/sdk/v1.10.0/js/MicrosoftTeams.min.js"
            integrity="sha384-6oUzHUqESdbT3hNPDDZUa/OunUj5SoxuMXNek1Dwe6AmChzqc6EJhjVrJ93DY/Bv"
            crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        microsoftTeams.initialize(()=>{
            viewLocation(); 
        })

         // Method to get current user's geo location
         // If the value of allowChooseLocation is true, then the users can choose any location of their choice.
         // If the value of allowChooseLocation is false, then the users cannot change their current location.
         // If the value of showMap is false, the current location is fetched without displaying the map. 
         // showMap is ignored if allowChooseLocation is set to true.
        function viewLocation() {
            let location = {"latitude":28.704059,"longitude":77.10249};
            // Methos to ask for permission and then show current user location
             microsoftTeams.location.showLocation(location, (error, result) => {
            // If there's any error, an alert shows the error message/code
            if (error)
            {
            if (error.message)
            {
              alert(" ErrorCode: " + error.errorCode + error.message);
            }
            else 
            {
              alert(" ErrorCode: " + error.errorCode);
            }

             return;
        }
        });
        } 
  
        function submitLoaction() {
            var geoLoaction= document.getElementById("locationText").innerHTML;
            microsoftTeams.tasks.submitTask(geoLoaction);
        }
    </script>
    <style>
        .submitClick{
            margin:5rem;
            margin-left:0rem;
        }
    </style>
</head>
<body class="theme-light">
    <div class="surface">
        <div class="panel">
            <div>
            </div>
        </div>
    </div>
</body>